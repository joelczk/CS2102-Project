CREATE TABLE Courses (
	cid	 	VARCHAR(10) PRIMARY KEY,
	cname 		VARCHAR(100) NOT NULL
);

CREATE TABLE Users (
	id		VARCHAR(6) PRIMARY KEY UNIQUE,
	name		VARCHAR(100) NOT NULL UNIQUE,
	image_file	VARCHAR(100) NOT NULL DEFAULT 'default.jpg',
	password	VARCHAR(100) NOT NULL
);

CREATE TABLE Professors (
	pid		VARCHAR(6) PRIMARY KEY REFERENCES Users(id),
	cname		VARCHAR(100) REFERENCES Courses(cid)
);

CREATE TABLE Students (
	sid		VARCHAR(6) PRIMARY KEY REFERENCES Users(id),
	year		integer
);

/*AY refers to the academic year that the student took the module*/
CREATE TABLE TakenCourses (
	sid 	 	VARCHAR(6) REFERENCES Students(sid),
	cid	 	VARCHAR(10) REFERENCES Courses(cid),
	ay 		VARCHAR(10) NOT NULL,
	sem	 	INTEGER NOT NULL CHECK (sem = 1 OR sem = 2),
	grade 		VARCHAR(5) DEFAULT NULL,
	PRIMARY KEY 	(sid, cid)
);

CREATE TABLE Groups (
	gid 		integer UNIQUE,
	gname		varchar(20),
	pid		varchar(6) REFERENCES Professors(pid),
	sid 		varchar(6) REFERENCES Students(sid)
);

CREATE TABLE TeachingAssistant (
	sid	 	VARCHAR(6),
	cid	 	VARCHAR(10) NOT NULL,
	is_ta 		BOOLEAN DEFAULT TRUE,
	FOREIGN KEY 	(sid, cid) REFERENCES TakenCourses(sid, cid)
);

CREATE TABLE GroupInfo (
	gid	 	INTEGER REFERENCES Groups(gid) ON DELETE CASCADE,
	sid	 	VARCHAR(6) REFERENCES Students(sid)
);

CREATE TABLE Posts (
	fid		INTEGER NOT NULL,
	tid		INTEGER NOT NULL,
	post_num	INTEGER NOT NULL,
	id 		VARCHAR(10) NOT NULL,
	title		VARCHAR(100) NOT NULL,
	date_posted	DATETIME NOT NULL,
	rating 		INTEGER NOT NULL DEFAULT '0',
	pfid		INTEGER,
	ptid		INTEGER,
	ppost_num	INTEGER,
	CHECK(rating >= 0 and rating <= 10)
);

CREATE TABLE Threads(
	fid		INTEGER NOT NULL,
	tid 		INTEGER NOT NULL,
	id		VARCHAR(10) NOT NULL,
	title		VARCHAR(100) NOT NULL,
	content		TEXT NOT NULL,
	date_created	TIMESTAMP NOT NULL
);

<-- Set timezone for the current session to become GMT +8(Singapore/Asia) time -->
set timezone to 'GMT +8';

CREATE TABLE ForumInfo (
	fid 		INTEGER NOT NULL,
	gid		INTEGER NOT NULL
);	

CREATE TABLE Forums(
	fid		INTEGER NOT NULL,
	title		VARCHAR(100) NOT NULL,
	pid		VARCHAR(10) NOT NULL,
	date_created	TIMESTAMP NOT NULL
);


